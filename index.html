<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <!-- –®—Ä–∏—Ñ—Ç Nunito -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
      :root {
        --accent: #8A8EE9;
        --accent-hover: #7075e2;
        --result-bg: #F0F1FD;
        --text-color: #111827;
        --muted: #6B7280;
        --error: #f97373;
        --error-bg: #FEF2F2;
      }

      body {
        font-family: "Nunito", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        padding: 24px;
        margin: 0;
        background: #ffffff;
        color: var(--text-color);
      }

      .layout {
        max-width: 900px;
        margin: 0 auto;
        display: flex;
        gap: 24px;
        align-items: flex-start;
      }

      .calculator {
        flex: 1;
      }

      .tasks-panel {
        width: 260px;
      }

      .title {
        text-align: center;
        font-size: 28px;
        font-weight: 700;
        margin-bottom: 24px;
        line-height: 1.25;
      }

      .title span {
        display: block;
        font-size: 18px;
        font-weight: 500;
        color: var(--muted);
        margin-top: 4px;
      }

      label {
        display: block;
        margin-top: 16px;
        margin-bottom: 4px;
        font-weight: 600;
      }

      input[type="number"] {
        width: 100%;
        box-sizing: border-box;
        padding: 10px 12px;
        font-size: 16px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
        font-family: "Nunito";
      }

      input[type="number"]:focus {
        outline: none;
        border-color: var(--accent);
        box-shadow: 0 0 0 2px rgba(138, 142, 233, 0.25);
      }

      /* –∫—Ä–∞—Å–Ω–∞—è –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö –ø–æ–ª–µ–π */
      .input-error {
        border-color: var(--error);
        background: var(--error-bg);
      }

      .btn-primary {
        width: 100%;
        margin-top: 24px;
        padding: 12px 16px;
        font-size: 20px;
        font-weight: 700;
        border-radius: 10px;
        border: none;
        background: var(--accent);
        color: #ffffff;
        cursor: pointer;
        font-family: "Nunito";

        box-shadow: 0 4px 10px rgba(138, 142, 233, 0.4);
        transition: transform 0.08s ease, box-shadow 0.15s ease, background 0.15s ease;
      }

      .btn-primary:hover {
        background: var(--accent-hover);
        box-shadow: 0 5px 14px rgba(138, 142, 233, 0.55);
      }

      .btn-primary:active {
        transform: scale(0.97);
        box-shadow: 0 3px 8px rgba(138, 142, 233, 0.35);
      }

/* –°—Ç–∏–ª–∏ –¥–ª—è –¥–≤—É—Ö –∫–Ω–æ–ø–æ–∫ —Ä—è–¥–æ–º */
.buttons-row {
  display: flex;
  gap: 12px;
  margin-top: 24px;
}

.buttons-row .btn-primary {
  flex: 2;
  margin-top: 0;
}

.buttons-row .btn-secondary {
  flex: 1;
  margin-top: 0;
  padding: 12px 16px;
  font-size: 18px;
  font-weight: 700;
  border-radius: 10px;
  border: 2px solid var(--accent);
  background: #ffffff;
  color: var(--accent);
  cursor: pointer;
  font-family: "Nunito";
  
  box-shadow: 0 4px 10px rgba(138, 142, 233, 0.25);
  transition: transform 0.08s ease, box-shadow 0.15s ease, background 0.15s ease;
}

.buttons-row .btn-secondary:hover {
  background: #F3F4FF;
  box-shadow: 0 5px 14px rgba(138, 142, 233, 0.35);
}

.buttons-row .btn-secondary:active {
  transform: scale(0.97);
  box-shadow: 0 3px 8px rgba(138, 142, 233, 0.25);
}
      
      .result-box {
        margin-top: 24px;
        padding: 16px 18px;
        border-radius: 10px;
        background: var(--result-bg);
        line-height: 1.3;
        text-align: center;
        font-size: 18px;
      }

      /* shake-–∞–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –±–ª–æ–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ */
      .shake {
        animation: shake 0.35s ease;
      }

      @keyframes shake {
        0%   { transform: translateX(0); }
        20%  { transform: translateX(-4px); }
        40%  { transform: translateX(4px); }
        60%  { transform: translateX(-4px); }
        80%  { transform: translateX(4px); }
        100% { transform: translateX(0); }
      }

      /* –ü–∞–Ω–µ–ª—å –∑–∞–¥–∞–Ω–∏–π —Å–ø—Ä–∞–≤–∞ */

      .tasks-title {
        font-size: 18px;
        font-weight: 700;
        text-align: center;
        margin-bottom: 16px;
      }

      .task-buttons {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin-bottom: 16px;
      }

      .task-btn {
        width: 100%;
        padding: 12px 16px;
        font-size: 15px;
        font-weight: 700;
        border-radius: 10px;
        border: none;
        background: #ffffff;
        color: var(--text-color);
        cursor: pointer;
        text-align: center;
        font-family: "Nunito";

        box-shadow: 0 4px 10px rgba(138, 142, 233, 0.25);
        transition: transform 0.08s ease, box-shadow 0.15s ease, background 0.15s ease, color 0.15s ease;
      }

      .task-btn:hover {
        background: #F3F4FF;
        box-shadow: 0 5px 14px rgba(138, 142, 233, 0.35);
      }

      .task-btn.active {
        background: var(--accent);
        color: #ffffff;
        box-shadow: 0 5px 14px rgba(138, 142, 233, 0.55);
      }

      .task-btn:active {
        transform: scale(0.97);
      }

      .task-box {
        padding: 14px 16px;
        border-radius: 10px;
        background: #F9FAFB;
        font-size: 14px;
        line-height: 1.4;
        font-family: "Nunito";
        min-height: 140px;
      }

      .task-line {
        margin-bottom: 6px;
      }

      .task-heading {
        text-align: center;
        font-weight: 700;
        margin-bottom: 10px;
        font-size: 15px;
      }

      @media (max-width: 700px) {
        .layout {
          flex-direction: column;
        }

        .tasks-panel {
          width: 100%;
        }
      }
    </style>
  </head>

  <body>
    <h1 class="title">
      –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–π
      <span>–í—ã–±–µ—Ä–∏ –∑–∞–¥–∞–Ω–∏–µ –∏ –≤–ø–∏—à–∏ —á–∏—Å–ª–∞ –≤ —Å—Ç—Ä–æ–∫–∏ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞</span>
    </h1>

    <div class="layout">

          <!-- –õ–µ–≤–∞—è —á–∞—Å—Ç—å: –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä -->
      <div class="calculator">
        <label>–¶–µ–ª—å, —Ä—É–±.</label>
        <input id="goal" type="number" min="0" />

        <label>–£–∂–µ –µ—Å—Ç—å, —Ä—É–±.</label>
        <input id="have" type="number" min="0" />

        <label>–û—Ç–∫–ª–∞–¥—ã–≤–∞—é –≤ –¥–µ–Ω—å, —Ä—É–±.</label>
        <input id="perDay" type="number" min="0" />

        <!-- üîÑ –î–í–ï –ö–ù–û–ü–ö–ò –†–Ø–î–û–ú -->
        <div class="buttons-row">
          <button class="btn-primary" onclick="calculate()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
          <button class="btn-secondary" onclick="resetCalculator()">–°–±—Ä–æ—Å–∏—Ç—å</button>
        </div>

        <div id="result" class="result-box"></div>
      </div>

      <!-- –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å: –∑–∞–¥–∞–Ω–∏—è -->
      <div class="tasks-panel">
        <div class="tasks-title">–ó–∞–¥–∞–Ω–∏—è</div>

        <div class="task-buttons">
          <button class="task-btn" data-task="task1" onclick="setTask('task1')">1 –∑–∞–¥–∞–Ω–∏–µ</button>
          <button class="task-btn" data-task="task2" onclick="setTask('task2')">2 –∑–∞–¥–∞–Ω–∏–µ</button>
          <button class="task-btn" data-task="mine" onclick="setTask('mine')">–ú–æ–∏ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è</button>
        </div>

        <div id="taskText" class="task-box"></div>
      </div>

    </div>

    <script>
      // üîß –ó–ê–ú–ï–ù–ò –≠–¢–£ –°–°–´–õ–ö–£ –ù–ê –°–í–û–ô URL –ò–ó CLOUD FUNCTIONS
     const BACKEND_URL = '/.netlify/functions/calculate';

      async function calculate() {
        const goalInput   = document.getElementById("goal");
        const haveInput   = document.getElementById("have");
        const perDayInput = document.getElementById("perDay");
        const resultBox   = document.getElementById("result");

        let goal   = goalInput.value.trim();
        let have   = haveInput.value.trim();
        let perDay = perDayInput.value.trim();

        // —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ—à–ª—É—é –ø–æ–¥—Å–≤–µ—Ç–∫—É –∏ —à–µ–π–∫
        [goalInput, haveInput, perDayInput].forEach(inp =>
          inp.classList.remove("input-error")
        );
        resultBox.classList.remove("shake");

        // –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç—ã–µ –ø–æ–ª—è
        let hasEmpty = false;
        if (goal === "") {
          goalInput.classList.add("input-error");
          hasEmpty = true;
        }
        if (have === "") {
          haveInput.classList.add("input-error");
          hasEmpty = true;
        }
        if (perDay === "") {
          perDayInput.classList.add("input-error");
          hasEmpty = true;
        }

        if (hasEmpty) {
          resultBox.innerHTML = "<b>–û–π! –°—Ç—Ä–æ–∫–∏ –≤ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–µ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã</b>";
          // –∑–∞–ø—É—Å–∫–∞–µ–º —à–µ–π–∫ (reset offsetWidth, —á—Ç–æ–±—ã –∞–Ω–∏–º–∞—Ü–∏—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–ª–∞—Å—å)
          void resultBox.offsetWidth;
          resultBox.classList.add("shake");
          return;
        }

        // –∑–∞—â–∏—Ç–∞ –æ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
        goal   = Math.max(0, Number(goal));
        have   = Math.max(0, Number(have));
        perDay = Math.max(0, Number(perDay));

        goalInput.value   = goal;
        haveInput.value   = have;
        perDayInput.value = perDay;

        // üîÑ –í–´–ó–û–í –ù–û–í–û–ì–û –ë–≠–ö–ï–ù–î–ê
        try {
          const response = await fetch(BACKEND_URL, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ goal, have, perDay })
          });

          const result = await response.json();

          if (result.success) {
            showResult(result.data);
          } else {
            resultBox.innerHTML = `<b>–û—à–∏–±–∫–∞: ${result.error}</b>`;
          }
        } catch (error) {
          resultBox.innerHTML = `<b>–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}</b>`;
        }
      }

      function showResult(result) {
        document.getElementById("result").innerHTML =
          `–°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –∫–æ–ø–∏—Ç—å: <b>${result.days}</b><br>` +
          `–ù–∞–∫–æ–ø–ª–µ–Ω–æ –≤—Å–µ–≥–æ: <b>${result.result} —Ä—É–±.</b>`;
      }

      function setTask(task) {
        const taskBox = document.getElementById("taskText");
        let html = "";

        if (task === "task1") {
          html =
            "<div class='task-heading'>–°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –±—É–¥–µ—Ç –∫–æ–ø–∏—Ç—å –ì—Ä–∏—à–∞?</div>" +
            "<div class='task-line'>–ù–∞–±–æ—Ä —É—á—ë–Ω–æ–≥–æ ‚Äî 3 000&nbsp;—Ä—É–±.</div>" +
            "<div class='task-line'>–£–∂–µ –µ—Å—Ç—å —É –ì—Ä–∏—à–∏ ‚Äî 600&nbsp;—Ä—É–±.</div>" +
            "<div class='task-line'>–ì—Ä–∏—à–∞ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ—Ç –≤ –¥–µ–Ω—å ‚Äî 50 –∏–ª–∏ 150&nbsp;—Ä—É–±.</div>" +
            "<div class='task-line'>–°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –∫–æ–ø–∏—Ç—å ‚Äî ?</div>";
        } else if (task === "task2") {
          html =
            "<div class='task-heading'>–ê —Ç–µ–ø–µ—Ä—å —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –±—É–¥–µ—Ç –∫–æ–ø–∏—Ç—å –ì—Ä–∏—à–∞?</div>" +
            "<div class='task-line'>–ù–∞–±–æ—Ä —É—á—ë–Ω–æ–≥–æ ‚Äî 2 500&nbsp;—Ä—É–±.</div>" +
            "<div class='task-line'>–£–∂–µ –µ—Å—Ç—å —É –ì—Ä–∏—à–∏ ‚Äî 450&nbsp;—Ä—É–±.</div>" +
            "<div class='task-line'>–ì—Ä–∏—à–∞ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ—Ç –≤ –¥–µ–Ω—å ‚Äî 40&nbsp;—Ä—É–±.</div>" +
            "<div class='task-line'>–°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –∫–æ–ø–∏—Ç—å ‚Äî ?</div>";
        } else if (task === "mine") {
          html =
            "<div class='task-heading'>–°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –±—É–¥–µ—à—å –∫–æ–ø–∏—Ç—å —Ç—ã?</div>" +
            "<div class='task-line'>1. –í–ø–∏—à–∏ —Å—É–º–º—É –ø–æ–∫—É–ø–∫–∏, –Ω–∞ –∫–æ—Ç–æ—Ä—É—é —Ç—ã –∫–æ–ø–∏—à—å</div>" +
            "<div class='task-line'>2. –í–ø–∏—à–∏, —Å–∫–æ–ª—å–∫–æ —É —Ç–µ–±—è —É–∂–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–æ</div>" +
            "<div class='task-line'>3. –í–ø–∏—à–∏ —Å—É–º–º—É, –∫–æ—Ç–æ—Ä–æ–µ —Ç—ã –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ—à—å –≤ –¥–µ–Ω—å</div>" +
            "<div class='task-line'>4. –ù–∞–∂–º–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É ¬´–†–∞—Å—Å—á–∏—Ç–∞—Ç—å¬ª –∏ —É–∑–Ω–∞–π, —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π —Ç—ã –±—É–¥–µ—à—å –∫–æ–ø–∏—Ç—å</div>";
        }

function resetCalculator() {
  // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –ø–æ–ª—è –≤–≤–æ–¥–∞
  const goalInput = document.getElementById("goal");
  const haveInput = document.getElementById("have"); 
  const perDayInput = document.getElementById("perDay");
  const resultBox = document.getElementById("result");
  
  // –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è
  goalInput.value = "";
  haveInput.value = "";
  perDayInput.value = "";
  
  // –û—á–∏—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
  resultBox.innerHTML = "";
  
  // –£–±–∏—Ä–∞–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É –æ—à–∏–±–æ–∫
  goalInput.classList.remove("input-error");
  haveInput.classList.remove("input-error"); 
  perDayInput.classList.remove("input-error");
  
  // –£–±–∏—Ä–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
  resultBox.classList.remove("shake");
  
  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ñ–æ–∫—É—Å –Ω–∞ –ø–µ—Ä–≤–æ–µ –ø–æ–ª–µ
  goalInput.focus();
}
        
        taskBox.innerHTML = html;

        const buttons = document.querySelectorAll(".task-btn");
        buttons.forEach((btn) => {
          btn.classList.toggle("active", btn.dataset.task === task);
        });
      }

      // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ
      setTask('task1');
    </script>
  </body>
</html>
